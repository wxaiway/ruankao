# 软件架构设计

## 内容提要

- 软件架构的概念
- 基于架构的软件开发
- 软件架构风格
- 特定领域软件架构
- 软件质量属性
- 软件架构评估
- 软件产品线
- 构件与中间件技术

## 软件架构的概念

### 架构的本质

1. 软件架构为软件系统提供了一个结构、行为和属性的高级抽象。

2. 软件架构风格是特定应用领域的惯用模式，架构定义一个词汇表和一组约束。

![软件架构基本概念](/imgs/2025/foundation/09-software-architecture/software-architecture-basic-concept.jpg)

### 架构的作用

1. 软件架构是项目干系人进行交流的手段。

2. 软件架构是可传递和可复用的模型，通过研究软件架构可能预测软件的质量。

3. 软件架构使推理和控制的更改更加简单，有助于循序渐进的原型设计，可以作为培训的基础。

![架构的作用示意图](/imgs/2025/foundation/09-software-architecture/architecture-role-diagram.jpg)

### 软件架构=软件体系结构

#### 需求分析

![需求分析过程](/imgs/2025/foundation/09-software-architecture/requirements-analysis-process.jpg)

架构设计就是需求分配，即将满足需求的职责分配到组件上。

### 软件架构的概念练习题

以下叙述，（）不是软件架构的主要作用。

A. 在设计变更相对容易的阶段，考虑系统结构的可选方案
B. 便于技术人员与非技术人员就软件设计进行交互
C. 展现软件的结构、属性与内部交互关系
D. 表达系统是否满足用户的功能性需求

**答案：D**

### 软件架构设计与生命周期

**需求分析阶段**：模型转换关注两个问题：如何根据需求模型构建SA模型+模型转换可追溯。

**设计阶段**：SA研究关注得最早和最多的阶段。ADL、4+1视图。

**实现阶段**

**构件组装阶段**：在较高层次上实现系统，高效。

**部署阶段**：SA为部署提供高层视图指导。

**后开发阶段**：动态软件体系结构（内部执行和外部请求导致变化）、体系结构恢复与重建。

## 架构描述语言ADL

ADL是这样一种形式化语言，它在底层语义模型的支持下，为软件系统的概念体系结构建模提供了具体语法和概念框架。

![ADL基本架构](/imgs/2025/foundation/09-software-architecture/adl-basic-architecture.jpg)

### ADL的三个基本元素

**构件**：计算或数据存储单元。

**连接件**：用于构件之间交互建模的体系结构构造块及其支配这些交互的规则。

**架构配置**：描述体系结构的构件与连接件的连接图。

### 架构描述语言ADL练习题

架构描述语言（Architecture Description Language，ADL）是一种为明确说明软件系统的概念架构和对这些概念架构建模提供功能的语言。ADL主要包括以下组成部分：组件、组件接口、（）和架构配置。

A. 架构风格
B. 架构实现
C. 连接件
D. 组件约束

**答案：C**

## 4+1视图

### 视角与视图

从不同的视角来检查，所以会有不同的视图。

![4+1视图模型](/imgs/2025/foundation/09-software-architecture/4plus1-view-model.jpg)

### 架构的"4+1"视图

1995年Kruchten提出了著名的"4+1"视图，用来描述软件系统的架构。在"4+1"视图中，（）用来描述设计的对象模型和对象之间的关系；（）描述了系统的配置、装配等问题；（）描述设计中的可伸缩、吞吐率等问题。

A. 逻辑视图  B. 用例视图  C. 过程视图  D. 开发视图

**答案：A 逻辑视图  D 开发视图  C 过程视图**

## 基于架构的软件开发方法-概念

✓ ABSD方法是架构驱动，即强调由业务【商业】、质量和功能需求的组合驱动架构设计。

✓ ABSD方法有三个基础。第一个基础是功能的分解。在功能分解中，ABSD方法使用已有的基于模块的内聚和耦合技术；第二个基础是通过选择架构风格来实现质量和业务需求；第三个基础是软件模板的使用。

视角与视图：从不同的视角来检查，所以会有不同的视图。

用例用来捕获功能需求、特定场景【刺激、环境、响应】用来捕获质量需求。

### 基于架构的软件开发方法-开发过程

![ABSD开发过程1](/imgs/2025/foundation/09-software-architecture/absd-development-process-1.jpg)

ABSD能很好的【支持软件重用】

ABSD方法是一个自顶向下，递归细化的方法。

软件系统的体系结构通过该方法得到细化，直到能产生软件构件和类。

![ABSD开发过程2](/imgs/2025/foundation/09-software-architecture/absd-development-process-2.jpg)

![ABSD开发过程3](/imgs/2025/foundation/09-software-architecture/absd-development-process-3.jpg)

架构文档化过程的主要输出结果是架构规格说明和测试架构需求的质量设计说明书这两个文档。

文档的完整性和质量是软件架构成功的关键因素。

关于文档的三大注意事项：

✓ 文档要从使用者的角度进行编写

✓ 必须分发给所有与系统有关的开发人员

✓ 且必须保证开发者手上的文档是最新的

架构复审【架构评估】的目的是标识潜在的风险，及早发现架构设计中的缺陷和错误。

![ABSD实现阶段](/imgs/2025/foundation/09-software-architecture/absd-implementation-phase.jpg)

### 基于架构的软件开发方法-练习题

在基于体系结构的软件设计方法中，采用（）来描述软件架构，采用（）来描述功能需求，采用（）来描述质量需求。

A. 类图和序列图  B. 视角与视图
C. 构件和类图    D. 构件与功能

A. 类图          B. 视角
C. 用例          D. 质量场景

A. 连接件        B. 用例
C. 质量场景      D. 质量属性

**答案：B 视角与视图  C 用例  C 质量场景**

ABSDM（Architecture-Based Software Design Model）把整个基于体系结构的软件过程划分为体系结构需求、体系结构设计、体系结构文档化、（）、（）和体系结构演化等6个子过程。其中，（）过程的主要输出结果是体系结构规格说明和测试体系结构需求的质量设计说明书。

A. 体系结构复审  A. 体系结构实现  A. 体系结构设计
B. 体系结构测试  B. 体系结构测试  B. 体系结构需求
C. 体系结构变更  C. 体系结构建模  C. 体系结构文档化
D. 体系结构管理  D. 体系结构管理  D. 体系结构测试

**答案：A 体系结构复审  A 体系结构实现  C 体系结构文档化**

## 软件架构风格

架构风格定义了用于描述系统的术语表和一组指导构建系统的规则。

| 五大架构风格 | 子风格 |
|-------------|--------|
| 数据流风格【Data Flow】| 批处理【Batch Sequential】、管道-过滤器【Pipes and Filters】|
| 调用/返回风格【Call/Return】| 主程序/子程序【Main Program and Subroutine】、面向对象【Object-oriented】、分层架构【Layered System】|
| 独立构件风格【Independent Components】| 进程通信【Communicating Processes】、事件驱动系统（隐式调用）【Event system】|
| 虚拟机风格【Virtual Machine】| 解释器【interpreter】、规则系统【Rule-based System】|
| 以数据为中心【Data-centered】| 数据库系统【Database System】、黑板系统【Blackboard System】、超文本系统【Hypertext System】|

### 软件架构风格-数据流风格

![数据流风格-批处理](/imgs/2025/foundation/09-software-architecture/dataflow-style-batch.jpg)

前一步的处理结果是后一步的输入内容【数据驱动】

![数据流风格-管道过滤器](/imgs/2025/foundation/09-software-architecture/dataflow-style-pipe-filter.jpg)

| 优点 | 缺点 | 典型实例 |
|------|------|----------|
| 1. 松耦合【高内聚-低耦合】；<br>2. 良好的重用性/可维护性；<br>3. 可扩展性【标准接口适配】；<br>4. 良好的隐蔽性；<br>5. 支持并行。| 1. 交互性较差；<br>2. 复杂性较高；<br>3. 性能较差（每个过滤器都需要解析与合成数据）| 传统编译器、网络报文处理 |

![批处理vs管道过滤器对比](/imgs/2025/foundation/09-software-architecture/batch-vs-pipe-filter-comparison.jpg)

![数据流风格特点总结](/imgs/2025/foundation/09-software-architecture/dataflow-style-summary.jpg)

### 软件架构风格-调用/返回风格

![调用返回风格概述](/imgs/2025/foundation/09-software-architecture/call-return-style-overview.jpg)

#### 分层架构风格

各种构件

| 优点 | 缺点 | 特点 |
|------|------|------|
| 1. 良好的重用性，只要接口不变可用在其它处；<br>2. 可维护性好；<br>3. 可扩展性好，支持递增设计。| 1. 并不是每个系统都方便分层；<br>2. 很难找到一个合适的、正确的层次抽象方法；<br>3. 不同层次之间耦合度高的系统很难实现。| 各个层次的组件形成不同功能级别的虚拟机；<br>多层相互协同工作，而且实现透明。|

### 软件架构风格-独立构件风格

![独立构件风格-进程通信](/imgs/2025/foundation/09-software-architecture/independent-component-process-communication.jpg)

![独立构件风格-事件驱动](/imgs/2025/foundation/09-software-architecture/independent-component-event-driven.jpg)

| 优点 | 缺点 | 特点 |
|------|------|------|
| 1. 松耦合。<br>2. 良好的重用性/可修改性/可扩展性。| 1. 构件放弃了对系统计算的控制。一个构件触发一个事件时，不能确定其他构件是否会响应它。而且即使它知道事件注册了哪些构件的过程，它也不能保证这些过程被调用的顺序。<br>2. 数据交换的问题。<br>3. 既然过程的语义必须依赖于被触发事件的上下文约束，关于正确性的推理就存在问题。| 系统由若干子系统构成且成为一个整体；系统有统一的目标；子系统有主从之分；每一子系统有自己的事件收集和处理机制 |

![独立构件风格应用场景](/imgs/2025/foundation/09-software-architecture/independent-component-applications.jpg)

### 软件架构风格-虚拟机风格

![虚拟机风格-解释器](/imgs/2025/foundation/09-software-architecture/virtual-machine-interpreter.jpg)

![虚拟机风格-规则系统](/imgs/2025/foundation/09-software-architecture/virtual-machine-rule-system.jpg)

![虚拟机风格对比](/imgs/2025/foundation/09-software-architecture/virtual-machine-comparison.jpg)

![虚拟机风格总结](/imgs/2025/foundation/09-software-architecture/virtual-machine-summary.jpg)

| 子分类 | 优点 | 缺点 | 特点 | 适合领域 |
|--------|------|------|------|----------|
| 解释器 | 可以灵活应对自定义场景 | 复杂度较高 | | 适用于需要"自定义规则"的场合 |
| 规则为中心 | 可以灵活应对自定义场景 | 复杂度较高 | 在解释器的基础上增加经验规则 | 适用于专家系统 |

#### 解释器体系结构风格

数据存储

#### 规则系统体系结构风格

基于规则的系统构成：规则集、规则解释器、规则/数据选择及工作内存，一般用在人工智能领域和DSS（决策支持系统）中。

### 软件架构风格-以数据为中心

构件    构件    构件

    数据仓库

![以数据为中心-数据库系统](/imgs/2025/foundation/09-software-architecture/data-centered-database-system.jpg)

构件    构件    构件

计算

![以数据为中心-黑板系统](/imgs/2025/foundation/09-software-architecture/data-centered-blackboard-system.jpg)

| 架构风格 | 子分类 | 优点 | 缺点 | 特点 | 典型实例 |
|----------|--------|------|------|------|----------|
| 以数据为中心 | 数据库系统 | | | 以数据为中心 | |
| 以数据为中心 | 黑板系统 | 可更改性和可维护性；可重用的知识源；容错性和健壮性 | 测试困难；不能保证有好的解决方案；难以建立好的控制策略；低效；开发困难；缺少并行机制 | 在以数据为中心的基础上，使用中心数据触发业务逻辑部件 | 语音识别、模式识别、图像处理、知识推理 |

![闭环控制系统](/imgs/2025/foundation/09-software-architecture/closed-loop-control-system.jpg)

✓ 适合于嵌入式系统，用于解决简单闭环控制问题。

✓ 经典应用：空调温控，定速巡航。

### 软件架构风格-C2风格

![C2架构风格](/imgs/2025/foundation/09-software-architecture/c2-architecture-style.jpg)

C2架构的基本规则：

✓ 构件和连接件都有一个顶部和一个底部。

构件的顶部要连接到连接件的底部，构件的底部要连接到连接件的顶部，构件之间不允许直连。

一个连接件可以和任意数目的其他构件和连接件连接。

当两个连接件进行直接连接时，必须由其中一个的底部到另一个的顶部。

### 软件架构风格-架构风格判断

Java程序可以做到"一次编写，到处运行"，从架构风格上看符合（）风格的特点。

在网络通信中，进行包的解析，一般先进行包头的分离，然后进行报文解析及后续处理，根据这一特点，选用（）风格最合适。

某公司欲开发一个基于图形用户界面的集成调试器。该调试器的编辑器和变量监视器可以设置调试断点。当调试器在断点处暂停运行时，编辑程序可以自动卷屏到断点，变量监视器刷新变量数值。针对这样的功能描述，采用（）的架构风格最为合适。

某游戏公司欲开发一个大型多人即时战略游戏，游戏设计的目标之一是能够支持玩家自行创建战役地图，定义游戏对象的行为和对象之间的关系。针对该目标，公司应该采用（）架构风格最为合适。（四选一：管道-过滤器、隐式调用、主程序-子程序、解释器）

某公司承接了一个开发家用空调自动调温器的任务，调温器测量外部空气温度，根据设定的期望温度控制空调的开关。根据该需求，公司应采用（）架构风格最为合适。（四选一：解释器、过程控制、分层、管道-过滤器）

**答案：虚拟机风格、管道-过滤器、隐式调用、解释器、过程控制**

某公司欲开发一个语音识别系统，语音识别的主要过程包括分割原始语音信号、识别音素、产生候选词、判定语法片段、提供语义解释等。每个过程都需要进行基于先验知识的条件判断并进行相应的识别动作。针对该系统的特点，采用（）架构风格最为合适。（四选一：解释器、面向对象、黑板、隐式调用）

某公司欲开发一个漫步者机器人，用来完成火星探测任务。机器人的控制者首先定义探测任务和任务之间的时序依赖性，机器人接受任务后，需要根据自身状态和外界环境进行动态调整，最终自动完成任务。针对这些需求，该机器人应该采用（）架构风格最为合适。（四选一：解释器、主程序-子程序、隐式调用、管道-过滤器）

Windows操作系统在图形用户界面处理方面采用的核心架构风格是（）风格。

**答案：黑板、解释器、事件驱动**

### 软件架构风格-练习题

"编译器"是一种非常重要的基础软件，其核心功能是对源代码形态的单个或一组源程序依次进行预处理、词法分析、语法分析、语义分析、代码生成、代码优化等处理，最终生成目标机器的可执行代码。考虑以下与编译器相关的软件架构设计场景：传统的编译器设计中，上述处理过程都以独立功能模块的形式存在，程序源代码作为一个整体，依次在不同模块中进行传递，最终完成编译过程。针对这种设计思路，传统的编译器采用（1）架构风格比较合适。

随着编译、链接、调试、执行等开发过程的一体化趋势发展，集成开发环境（IDE）随之出现。IDE集成了编译器、连接器、调试器等多种工具，支持代码的增量修改与处理，能够实现不同工具之间的信息交互，覆盖整个软件开发生命周期。针对这种需求，IDE采用（2）架构风格比较合适。IDE强调交互式编程，用户在修改程序代码后，会同时触发语法高亮显示、语法错误提示、程序结构更新等多种功能的调用与结果呈现，针对这种需求，通常采用（3）架构风格比较合适。

某公司已经开发了一款针对某种嵌入式操作系统专用编程语言的IDE，随着一种新的嵌入式操作系统上市并迅速占领市场，公司决定对IDE进行适应性改造，支持采用现有编程语言进行编程，生成符合新操作系统要求的运行代码，并能够在现有操作系统上模拟出新操作系统的运行环境，以支持代码调试工作。针对上述要求，为了使IDE能够生成符合新操作系统要求的运行代码，采用基于（4）的架构设计策略比较合适；为了模拟新操作系统的运行环境，通常采用（5）架构风格比较合适。

（1）A. 管道-过滤器 B. 顺序批处理 C. 过程控制 D. 独立进程
（2）A. 规则引擎 B. 解释器 C. 数据共享 D. 独立构件
（3）A. 隐式调用 B. 显式调用 C. 主程序-子程序 D. 层次结构
（4）A. 代理 B. 适配 C. 包装 D. 模拟
（5）A. 隐式调用 B. 仓库结构 C. 基于规则 D. 虚拟机

**答案：（1）A 管道-过滤器 （2）C 数据共享 （3）A 隐式调用 （4）B 适配 （5）D 虚拟机**

## 软件架构风格-MDA

### Model Driven Architecture

- Model?
  客观事物的抽象表示

- Architecture?
  构成系统的部件、连接件及其约束的规约

- Model-Driven?
  使用模型完成软件的分析、设计、构建、部署、维护等各开发活动

- MDA起源于分离系统规约和平台实现的思想

### 软件架构风格-MDA

MDA的核心模型：

**计算无关模型（CIM）**：对某具体行业内一个项目的业务需求及其系统功能需求进行分析

**平台独立模型（PIM）**：具有高抽象层次、独立于任何实现技术的模型。

**平台相关模型（PSM）**：为某种特定实现技术量身定做，让你用这种技术中可用的实现构造来描述系统的模型。PIM会被变换成一个或多个PSM。

**代码（Code）**：用源代码对系统的描述（规约）。每个PSM都将被变换成代码。

![MDA模型转换](/imgs/2025/foundation/09-software-architecture/mda-model-transformation.jpg)

PIM → 变换工具 → PSM → 变换工具 → CODE

水平复用：不分行业领域，通用
垂直复用：分行业领域，专用

## 软件架构复用

【软件复用】是一种系统化的软件开发过程，通过识别、分析、分类、获取和修改软件实体，以便在不同软件开发过程中重复使用它们。

★ 软件开发过程中重复使用相同或相似【软件元素】的过程。

### 复用的历史发展线路

![复用发展历程](/imgs/2025/foundation/09-software-architecture/reuse-development-history.jpg)

### 复用的维度

| 软件架构复用类型 | 机会复用 | 开发过程中，只要发现有可复用资产，就对其进行复用 |
|------------------|----------|-------------------------------------------|
| 软件架构复用类型 | 系统复用 | 开发之前，要进行规划，以决定哪些需要复用 |

## 特定领域软件架构（DSSA）-基本概念

**定义**：特定领域软件架构以一个特定问题领域为对象，形成由领域参考模型、参考需求、参考架构等组成的开发基础架构，支持一个特定领域中多个应用的生成。

### DSSA类型

> 垂直域：相同领域，深入

> 水平域：不同领域，平移

### DSSA-参与人员

![DSSA参与人员](/imgs/2025/foundation/09-software-architecture/dssa-participants.jpg)

参与DSSA的人员

1. **领域专家**：有经验的用户、从事该领域中系统的需求分析、设计、实现以及项目管理的有经验的软件工程师等。

领域专家的主要任务包括提供关于领域中系统的需求规约和实现的知识。

2. **领域分析人员**：领域分析人员应由具有知识工程背景的有经验的系统分析员来担任。

3. **领域设计人员**：领域设计人员应由有经验的软件设计人员来担任。

4. **领域实现人员**：领域实现人员应由有经验的程序设计人员来担任。

### 特定领域软件架构（DSSA）-建立过程

![DSSA建立过程](/imgs/2025/foundation/09-software-architecture/dssa-establishment-process.jpg)

### 特定领域软件架构（DSSA）-三层次模型

| 领域架构师 | 领域开发环境 |
|------------|-------------|
| 参考需求 | 领域模型 |
| 应用工程师 | 具体应用 |
| 领域特定的应用开发环境 |
| 操作员 | 实例化的架构 |
| 应用执行环境 |

特定领域软件架构（DSSA）

DSSA是在一个特定应用领域中为一组应用提供组织结构参考的软件体系结构，参与DSSA的人员可以划分为4种角色，包括领域专家、领域设计人员、领域实现人员和（），其基本活动包括领域分析、领域设计和（）。

A. 领域测试人员 B. 领域顾问 C. 领域分析师 D. 领域经理
A. 领域建模 B. 架构设计 C. 领域实现 D. 领域评估

**答案：C 领域分析师  C 领域实现**

## 软件产品线

应用领域

## 软件架构评估

✓ 为什么要进行架构评估？

架构评估到底评什么？

架构评估怎么评？

### 软件架构评估-质量属性

性能

容错

可靠性

健壮性

可用性

质量属性 ← 安全性 → 可维护性

可修改性 ← 可扩展性

功能性 ← 结构重组

可变性 ← 可移植性

互操作性

#### 1. 性能

性能（performance）是指系统的响应能力，即要经过多长时间才能对某个事件做出响应，或者在某段时间内系统所能处理的事件的个数。

例如：

（1）同时支持1000并发；

（2）响应时间小于1s；

（3）显示分辨率达到4K。

![性能质量属性](/imgs/2025/foundation/09-software-architecture/performance-quality-attribute.jpg)

#### 2. 可用性

可用性（availability）是系统能够正常运行的时间比例。经常用两次故障之间的时间长度或在出现故障时系统能够恢复正常的速度来表示。

例如：

（1）主服务器故障，1分钟内切换至备用服务器；

（2）系统故障，1小时内修复；

![可用性质量属性](/imgs/2025/foundation/09-software-architecture/availability-quality-attribute.jpg)

#### 3. 安全性

安全性（security）是指系统在向合法用户提供服务的同时能够阻止非授权用户使用的企图或拒绝服务的能力。安全性又可划分为机密性【信息不泄露给未授权的用户】、完整性【防止信息被篡改】、不可否认性【不可抵赖】及可控性【对信息的传播及内容具有控制的能力】等特性。

例如：

（1）可抵御SQL注入攻击；

（2）对计算机的操作都有完整记录；

![安全性质量属性](/imgs/2025/foundation/09-software-architecture/security-quality-attribute.jpg)

#### 4. 可修改性

可修改性（modifiability）的能力。通常以某些具体的变更为基准，通过考察这些变更的代价衡量可修改性。

可修改性包含4个方面：可维护性、可扩展性、结构重组、可移植性。

例如：

（1）更改系统报表模块，必须在2人周内完成；

（2）对Web界面风格进行修改，修改必须在4人月内完成。

![可修改性质量属性](/imgs/2025/foundation/09-software-architecture/modifiability-quality-attribute.jpg)

推迟绑定时间

| 运行时注册 |
|-----------|
| 配置文件 |
| 多态 |
| 组件更换 |
| 遵守已定义的协议 |

#### 5. 易用性

易用性关注的是对用户来说完成某个期望任务的容易程度和系统所提供的用户支持的种类。

例如：

（1）界面友好；

（2）新用户学习使用系统时间不超过2小时。

#### 6. 可测试性

软件可测试性是指通过测试揭示软件缺陷的容易程度。

例如：

（1）提供远程调试接口，支持远程调试。

### 软件架构评估-质量属性练习题

某服务器软件系统对可用性（Availability）、性能（Performance）和可修改性（Modification）的要求较高，（）设计策略能提高该系统的可用性，（）设计策略能够提高该系统的性能，（）设计策略能够提高该系统的可修改性。

A. Ping/Echo B. 限制访问 C. 运行时注册 D. 接口-实现分离
A. 分层结构 B. 事务机制 C. 主动冗余 D. 队列调度
A. 信息隐藏 B. 记录/回放 C. 任务模型 D. 回滚

**答案：C 主动冗余  D 队列调度  A 信息隐藏**

某公司欲开发一个电子交易清算系统，在架构设计阶段，公司的架构师识别出3个核心质量属性场景。其中"数据传递时延不大于1s，并提供相应的优先级管理"主要与（）质量属性相关，通常可采用（）架构策略实现该属性；"系统采用双机热备，主备机必须实时监测对方状态，以便完成系统的实时切换"主要与（）质量属性相关，通常可采用（）架构策略实现该属性；"系统应能够防止99%的黑客攻击"主要与（）质量属性相关，通常可采用（）架构策略实现该属性。

A. 可用性 B. 性能 C. 安全性 D. 可修改性
A. 限制资源 B. 引入并发 C. 资源仲裁 D. 限制访问
A. 可用性 B. 性能 C. 安全性 D. 可修改性
A. 记录/回放 B. 操作串行化 C. 心跳 D. 资源调度
A. 可用性 B. 性能 C. 安全性 D. 可修改性
A. 检测攻击 B. Ping/Echo C. 选举 D. 权限控制

**答案：B 性能  C 资源仲裁  A 可用性  C 心跳  C 安全性  A 检测攻击**

## 软件架构评估

敏感点是一个或多个构件（和/或构件之间的关系）的特性，它能影响系统的某个质量属性。

权衡点是影响多个质量属性的特性，是多个质量属性的敏感点。

![架构评估概念关系](/imgs/2025/foundation/09-software-architecture/architecture-evaluation-concept.jpg)

风险点是指架构设计中潜在的、存在问题的架构决策所带来的隐患。非风险点是指不会带来隐患，一般以"XXX要求是可以实现（或接受）的"方式表达。

例如：

（1）对交易请求处理时间的要求将影响系统的数据传输协议和处理过程的设计；

（2）假设每秒中用户交易请求的数量是10个，处理请求的时间为30毫秒，则"在1秒内完成用户的交易请求"这一要求是可以实现的；

（3）目前对系统信用卡支付业务逻辑的描述尚未达成共识，这可能导致部分业务功能模块的重复，影响系统的可修改性；

（4）更改加密的级别将对安全性和性能产生影响。

### 质量属性相互影响表

| | 性能 | 安全性 | 可用性 | 易用性 | 可测试性 | 可维护性 |
|---|------|--------|--------|--------|----------|----------|
| 性能 | | ➖ | | ➖ | ➖ | ➖ |
| 安全性 | ➖ | | | ➖ | ➖ | |
| 可用性 | | | | | | |
| 易用性 | ➖ | | ➖ | | | |
| 可测试性 | ➖ | | | | | ➕ |
| 可维护性 | ➖ | | ➕ | | ➕ | |

### 软件架构评估-架构评估方法

✓ 基于调查问卷（检查表）的方式

✓ 基于度量的方式

基于场景的方式

| 评估方式 | 调查问卷或检查表 | 调查问卷或检查表 | 场景 | 度量 |
|----------|------------------|------------------|------|------|
| 评估方式 | 调查问卷 | 检查表 | 场景 | 度量 |
| 通用性 | 通用 | 特定领域 | 特定系统 | 通用或特定领域 |
| 评估者对架构的了解程度 | 粗略了解 | 无限制 | 中等了解 | 精确了解 |
| 实施阶段 | 早 | 中 | 中 | 中 |
| 客观性 | 主观 | 主观 | 较主观 | 较客观 |

【场景】是从风险承担者的角度与系统交互的简短描述。场景可从六个方面进行描述：刺激源、刺激、制品、环境、响应、响应度量

【性能场景示例】

![性能场景示例](/imgs/2025/foundation/09-software-architecture/performance-scenario-example.jpg)

质量属性场景的六个构成部分：

【刺激源（Source）】这是某个生成该刺激的实体（人、计算机系统或者任何其他刺激器）

【刺激（Stimulus）】该刺激是当刺激到达系统时需要考虑的条件。

【环境（Environment）】该刺激在某些条件内发生。当激励发生时，系统可能处于过载、运行或者其他情况。

【制品（Artifact）】某个制品被激励。这可能是整个系统（或系统的一部分）。

【响应（Response）】该响应是在激励到达后所采取的行动。

【响应度量（Measurement）】当响应发生时，应当能够以某种方式对其进行度量，以对需求进行测试。

### 软件架构评估-基于场景的评估方法

【软件架构分析法（SAAM）】最初关注可修改性，后扩充到可移植性、可扩充性等。

【架构权衡分析法（ATAM）】由SAAM发展而来，主要针对：性能、实用性、安全性、可修改性。

【成本效益分析法（CBAM）】在ATAM基础上建立的，软件的"经济"模型。

### 软件架构评估-SAAM

SAAM：最初用于分析架构可修改性，后扩展到其他质量属性。

![SAAM方法](/imgs/2025/foundation/09-software-architecture/saam-method.jpg)

单个架构评估

### 软件架构评估-ATAM

ATAM：在SAAM的基础上发展起来的，主要针对性能、实用性、安全性和可修改性，在系统开发之前，对这些质量属性进行评价和折中。

![ATAM方法](/imgs/2025/foundation/09-software-architecture/atam-method.jpg)

### 软件架构评估练习题

识别风险、非风险、敏感点和权衡点是进行软件架构评估的重要过程。"改变业务数据编码方式会对系统的性能和安全性产生影响"是对（）的描述，"假设用户请求的频率为每秒1个，业务处理时间小于30毫秒，则将请求响应时间设定为1秒钟是可以接受的"是对（）的描述。

A. 风险点 B. 非风险 C. 敏感点 D. 权衡点
A. 风险点 B. 非风险 C. 敏感点 D. 权衡点

**答案：D 权衡点  B 非风险**

Architecture Tradeoff Analysis Method（ATAM）是一种软件架构的评估方法，以下关于该方法的叙述中，正确的是（）。

A. ATAM是一种代码评估方法
B. ATAM需要评估软件的需求是否准确
C. ATAM需要对软件系统进行测试
D. ATAM不是一种精确的评估工具

**答案：D**

体系结构权衡分析方法（Architecture Tradeoff Analysis Method，ATAM）包含4个主要的活动领域，分别是场景和需求收集、体系结构视图和场景实现、（）、折中。基于场景的架构分析方法（Scenarios-based Architecture Analysis Method，SAAM）的主要输入是问题描述、需求声明和（）。

A. 架构设计 B. 问题分析与建模
C. 属性模型构造和分析 D. 质量建模

A. 问题说明 B. 问题建模
C. 体系结构描述 D. 需求建模

**答案：C 属性模型构造和分析  C 体系结构描述**

## 构件与中间件技术-概念

### 构件的定义

**定义1**：软件构件是一种组装单元，它具有规范的接口规约和显式的语境依赖。软件构件可以被独立地部署并由第三方任意地组装。

**定义2**：构件是某系统中有价值的、几乎独立的并可替换的一个部分，它在良好定义的体系结构语境内满足某清晰的功能。

**定义3**：构件是一个独立发布的功能部分，可以通过其接口访问它的服务。

| 模块的特性 |
|------------|
| 结构化开发的产物 |

| 对象的特性 |
|------------|
| 1. 一个实例单元，具有唯一的标志；<br>2. 可能具有状态，此状态外部可见；<br>3. 封装了自己的状态和行为。 |

| 构件的特性 |
|------------|
| 1. 独立部署单元；<br>2. 作为第三方的组装单元；<br>3. 没有（外部的）可见状态。 |

### 构件与中间件技术-构件的复用

#### 检索与提取构件

**1. 基于关键字的检索**

特点：
树形或有向无回路图结构

![构件检索方法1](/imgs/2025/foundation/09-software-architecture/component-retrieval-method-1.jpg)

**2. 刻面检索法**

特点：
利用Facet描述构件执行的功能、被操作的数据、构件应用的语境或任意其他特征

例如：分多个刻面：
1. 应用领域
2. 使用环境
3. 功能

**3. 超文本检索法**

特点：按照人类的联想思维方式任意跳转到包含相关概念或构件的文档

#### 修改构件

#### 组装构件

![构件复用过程](/imgs/2025/foundation/09-software-architecture/component-reuse-process.jpg)

1. 要复用构件，准确地理解构件至关重要。特别是对构件修改使用时。

![构件理解要求](/imgs/2025/foundation/09-software-architecture/component-understanding-requirements.jpg)

2. 为达到目的，必须要求构件的开发过程遵循公共标准。

3. 一般构件库的文档中全面而准确地说明以下内容：

构件的功能与行为、相关的领域知识、可适应性约束条件与例外情形、可以预见的修改部分及修改方法。

#### 理解与评价构件

1. 理想状态是直接复用构件库中现成的构件，但大多数情况下，必须对构件进行或多或少的修改，以应对新需求。

![构件修改适配](/imgs/2025/foundation/09-software-architecture/component-modification-adaptation.jpg)

2. 为了减少构件修改的工作量，要求开发人员尽量使构件的功能、行为和接口设计更为抽象化、通用化和参数化。这样，复用者即可通过对实参的选取来调整构件的功能或行为。如果这种调整仍不足以使构件适用于新系统，复用者就必须借助设计信息和文档来修改构件。

3. 构件库中若无可修改使用的构件，则按新需求开发构件，并存入构件库。

#### 组装构件

组装的三种方式

1. **基于功能的组装**：采用子程序调用和参数传递的方式将构件组装起来。

2. **基于数据的组装**：仍然是传统的子程序调用与参数传递。但它所依赖的软件设计方法不再是功能分解，而是面向数据的设计方法，例如，Jackson系统开发方法。

![构件组装方式](/imgs/2025/foundation/09-software-architecture/component-assembly-methods.jpg)

3. **面向对象的组装**：如果从类库中检索出来的基类能够完全满足新系统的需求，则可以直接应用。否则，必须以基类为父类，生成相应的子类，以满足新系统的需求。

#### 构件组装失配问题

1. 由构件引起的失配，包括由于系统对构件基础设施、构件控制模型和构件数据模型的假设存在冲突引起的失配；

2. 由连接子引起的失配，包括由于系统对构件交互协议、连接子数据模型的假设存在冲突引起的失配；

3. 由于系统成分对全局体系结构的假设存在冲突引起的失配等。要解决失配问题，首先需要检测出失配问题，并在此基础上通过适当的手段消除检测出的失配问题。

### 构件与中间件技术-构件的复用练习题

构件组装是指将库中的构件经适当修改后相互连接构成新的目标软件。（）不属于构件组装技术。

A. 基于功能的构件组装技术
B. 基于数据的构件组装技术
C. 基于实现的构件组装技术
D. 面向对象的构件组装技术

**答案：C**

### 构件与中间件技术-构件的分类

从构件的外部形态来看，构件可分为5类：

（1）**独立而成熟的构件**。已在实际运行环境多次检验，该类构件隐藏了所有接口，用户只需用规定好的命令进行使用。例如，数据库管理系统和操作系统等。

（2）**有限制的构件**。有限制的构件提供了接口，指出了使用的条件和前提，这种构件在装配时，会产生资源冲突、覆盖等影响，在使用时需要加以测试。例如，各种面向对象程序设计语言中的基础类库等。

（3）**适应性构件**。适应性构件进行了包装或使用了接口技术，把不兼容性、资源冲突等进行了处理，可以直接使用。这种构件可以不加修改地使用在各种环境中。例如ActiveX等。

（4）**装配的构件**。装配（assemble）的构件在安装时，已经装配在操作系统、数据库管理系统或信息系统不同层次上，使用胶水代码（glue code）就可以进行连接使用。目前一些软件商提供的大多数软件产品都属这一类。

（5）**可修改的构件**。对原构件修改错误、增加新功能，可以利用重新"包装"或写接口来实现构件的版本替换。这种构件在应用系统开发中使用得比较多。

## 中间件

中间件是一类构件

中间件是一类系统软件

![中间件层次图](/imgs/2025/foundation/09-software-architecture/middleware-layer-diagram.jpg)

简化结构、屏蔽差异、利于复用

### 中间件

#### 采用中间件技术的优点

（1）面向需求。即设计师集中精力于业务逻辑本身。

（2）业务的分隔和包容性。应用开发人员可以按照不同的业务进行功能的划分，体现为不同的接口或交互模式。

（3）设计与实现隔离。构件对外发生作用或构件间的交互，都是通过接口进行的，构件使用者只需要知道构件的接口，而不必关心其内部实现，这是设计与实现分离的关键。

（4）隔离复杂的系统资源。架构很重要的一个功能就是将系统资源与应用构件隔离，这是保证构件可复用甚至"即插即用"的基础，与中间件的意图也是一致的。

（5）符合标准的交互模型。中间件则实现了架构的模型，实现了标准的协议。

（6）软件复用。中间件提供了构件封装、交互规则、与环境的隔离等机制，这些都为软件复用提供了方便的解决方案。

（7）提供对应用构件的管理。基于中间件的软件可以方便地进行管理，因为构件总可以通过标识机制进行划分。

### 中间件分类

| 中间件分类 | 特点 |
|------------|------|
| 通信处理（消息）中间件 | 可靠、高效、实时跨平台通信，eLink，MQSeries |
| 事务处理（交易）中间件 | 事务分发，负载均衡，Tuxedo |
| 数据存取管理中间件 | 为虚拟缓冲存取、格式转换、解压等带来方便 |
| Web服务器中间件 | 有负载均衡、缓存、安全性等功能 |
| 安全中间件 | 如：加密，认证等 |
| 跨平台和架构的中间件 | 解决跨平台问题，如：CORBA |
| 专用平台中间件 | 为特定应用领域设计领域参考模式，建立相应架构 |
| 网络中间件 | 功能包括网管、接入、网络测试、虚拟社区和虚拟缓冲等 |

![中间件技术栈](/imgs/2025/foundation/09-software-architecture/middleware-technology-stack.jpg)

![中间件应用场景](/imgs/2025/foundation/09-software-architecture/middleware-application-scenarios.jpg)

### 构件与中间件技术-CORBA

![CORBA架构图](/imgs/2025/foundation/09-software-architecture/corba-architecture-diagram.jpg)

**伺服对象（Servant）**：CORBA对象的真正实现，负责完成客户端请求。

**对象适配器（Object Adapter）**：用于屏蔽ORB内核的实现细节，为服务器对象的实现者提供抽象接口，以便他们使用ORB内部的某些功能。

**对象请求代理（Object Request Broker）**：解释调用并负责查找实现该请求的对象，将参数传给找到的对象，并调用方法返回结果。客户方不需要了解服务对象的位置、通信方式、实现、激活或存储机制。

### 构件与中间件技术-CORBA练习题

CORBA服务端构件模型中，（）是CORBA对象的真正实现，负责完成客户端请求。

A. 伺服对象（Servant）
B. 对象适配器（Object Adapter）
C. 对象请求代理（Object Request Broker）
D. 适配器激活器（Adapter Activator）

**答案：A**